% sheet 10 main

f = @(x) exp(x(1)*x(2)*x(3)*x(4)*x(5)) - 0.5*(x(1)^3 + x(2)^3 + 1)^2;
h = @(x) [x(1)^2 + x(2)^2  + x(3)^2 + x(4)^2 + x(5)^2 - 10 ; x(2)*x(3) - 5*x(4)*x(5); x(1)^3 + x(2)^3 + 1];

fv = @(x1,x2,x3,x4,x5) exp(x1*x2*x3*x4*x5) - 0.5*(x1^3 + x2^3 + 1)^2;
hv = @(x1,x2,x3,x4,x5) [x1^2 + x2^2 + x3^2 x4^2 x5^2 -10 ; x2*x3 - 5*4*x5; x1^3 + x2^3 + 1];

x0 = [-1.8, 1.4, 1.9, -0.8, -0.8];
mu0 = [0 0 0];
maxit = 1000;

Jh = @(x) [2*x(1), 2*x(2), 2*x(3), 2*x(4), 2*x(5); ...
    0, x(3), x(2), -5*x(5), -5*x(4); 3*x(1)^2, 3*x(2)^2, 0 ,0, 0];


L = @(x,mu) f(x) + mu'*h(x);

gradL = @(x) 